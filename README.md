# ğŸ“¦ **è²·ã„ç‰©ãƒªã‚¹ãƒˆå…±æœ‰ã‚¢ãƒ—ãƒª - Shared Shopping List**
**Firebase ã‚’æ´»ç”¨ã—ãŸãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ è²·ã„ç‰©ãƒªã‚¹ãƒˆç®¡ç†ã‚¢ãƒ—ãƒª**

## ğŸ“Œ **æ¦‚è¦**
æœ¬ã‚¢ãƒ—ãƒªã¯ã€ã‚°ãƒ«ãƒ¼ãƒ—ã§è²·ã„ç‰©ãƒªã‚¹ãƒˆã‚’å…±æœ‰ãƒ»ç®¡ç†ã§ãã‚‹iOSã‚¢ãƒ—ãƒªã§ã‚ã‚‹ã€‚  
**Firebase Authentication**, **Firestore Database**, **Cloud Messaging (FCM)**, **Cloud Functions** ã‚’æ´»ç”¨ã—ã€ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ã§ãƒ‡ãƒ¼ã‚¿ã®åŒæœŸã¨é€šçŸ¥ã‚’è¡Œã†ã€‚

## ğŸ¯ **ä¸»ãªæ©Ÿèƒ½**
### ğŸ“ è²·ã„ç‰©ãƒªã‚¹ãƒˆç®¡ç†
- ã‚°ãƒ«ãƒ¼ãƒ—ã”ã¨ã®ã‚¢ã‚¤ãƒ†ãƒ ç®¡ç†  
- ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ æ›´æ–°ã¨ä¸¦ã³æ›¿ãˆ  
- è³¼å…¥æ¸ˆã¿ãƒ•ãƒ©ã‚°ã®å¤‰æ›´
<img src="/ã‚¹ã‚¯ãƒªãƒ¼ãƒ³ã‚·ãƒ§ãƒƒãƒˆ/4.png" width="400px" />

### ğŸ‘¥ ã‚°ãƒ«ãƒ¼ãƒ—ç®¡ç†
- æ‹›å¾…ã‚³ãƒ¼ãƒ‰ã«ã‚ˆã‚‹ã‚°ãƒ«ãƒ¼ãƒ—å‚åŠ   
- ã‚°ãƒ«ãƒ¼ãƒ—ãƒ¡ãƒ³ãƒãƒ¼ã®ä¸€è¦§è¡¨ç¤º  
- Firestoreã‚’ç”¨ã„ãŸã‚¢ã‚¯ã‚»ã‚¹åˆ¶å¾¡
<img src="/ã‚¹ã‚¯ãƒªãƒ¼ãƒ³ã‚·ãƒ§ãƒƒãƒˆ/6.png" width="400px" />

### ğŸ”” ãƒ—ãƒƒã‚·ãƒ¥é€šçŸ¥ (FCM)
- ã‚¢ã‚¤ãƒ†ãƒ è³¼å…¥æ™‚ã«ã‚°ãƒ«ãƒ¼ãƒ—ãƒ¡ãƒ³ãƒãƒ¼ã¸é€šçŸ¥  
- Firebase Cloud Functions ã‚’æ´»ç”¨ã—ãŸé€šçŸ¥é€ä¿¡
<img src="/ã‚¹ã‚¯ãƒªãƒ¼ãƒ³ã‚·ãƒ§ãƒƒãƒˆ/5.png" width="400px" />
<img src="/ã‚¹ã‚¯ãƒªãƒ¼ãƒ³ã‚·ãƒ§ãƒƒãƒˆ/2.png" width="400px" />

### ğŸ”‘ ãƒ¦ãƒ¼ã‚¶ãƒ¼èªè¨¼ (Firebase Auth)* 
- ãƒ¡ãƒ¼ãƒ«ãƒ»ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰èªè¨¼  
- Firestore ã§ãƒ¦ãƒ¼ã‚¶ãƒ¼ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«ã‚’ç®¡ç†
- ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚«ãƒ©ãƒ¼ã‚„ç”»é¢è¨­å®šãªã©ã‚’å€‹åˆ¥ã«è¨­å®šå¯èƒ½
<img src="/ã‚¹ã‚¯ãƒªãƒ¼ãƒ³ã‚·ãƒ§ãƒƒãƒˆ/7.png" width="400px" />
<img src="/ã‚¹ã‚¯ãƒªãƒ¼ãƒ³ã‚·ãƒ§ãƒƒãƒˆ/1.png" width="400px" />

## ğŸ›  **ä½¿ç”¨æŠ€è¡“**
### ğŸ“± ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰
- **SwiftUI** - ãƒ¢ãƒ€ãƒ³ãªUIãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯
- **Combine** - ãƒ‡ãƒ¼ã‚¿ã®ãƒªã‚¢ã‚¯ãƒ†ã‚£ãƒ–ç®¡ç†
- **Firebase SDK** - Firestore, Authentication, Messaging é€£æº

### ğŸ”¥ ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰
- **Firebase Firestore** - NoSQLå‹ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹
- **Firebase Cloud Functions** - ãƒ—ãƒƒã‚·ãƒ¥é€šçŸ¥ã®é€ä¿¡
- **Firebase Authentication** - ãƒ¦ãƒ¼ã‚¶ãƒ¼ç®¡ç†
- **Firebase Cloud Messaging (FCM)** - ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ é€šçŸ¥

---
## ğŸ” **Firestore ãƒ‡ãƒ¼ã‚¿æ§‹é€ **
### ğŸ›’ **ã‚¢ã‚¤ãƒ†ãƒ  (`items` ã‚³ãƒ¬ã‚¯ã‚·ãƒ§ãƒ³)**
```json
{
  "id": "ã‚¢ã‚¤ãƒ†ãƒ ID",
  "name": "ã‚¢ã‚¤ãƒ†ãƒ å",
  "purchased": false,
  "order": 1,
  "location": "è³¼å…¥ã§ãã‚‹å ´æ‰€",
  "quantity": 1,
  "deadline": "2024-02-01",
  "memo": "è¿½åŠ æƒ…å ±",
  "registeredAt": "2024-01-30",
  "registrant": "ãƒ¦ãƒ¼ã‚¶ãƒ¼ID",
  "buyer": "è³¼å…¥è€…ID",
  "purchasedAt": "2024-02-01",
  "groupId": "ã‚°ãƒ«ãƒ¼ãƒ—ID"
}
```

### ğŸ‘¥ **ã‚°ãƒ«ãƒ¼ãƒ— (`groups` ã‚³ãƒ¬ã‚¯ã‚·ãƒ§ãƒ³)**
```json
{
  "id": "ã‚°ãƒ«ãƒ¼ãƒ—ID",
  "name": "ã‚°ãƒ«ãƒ¼ãƒ—å",
  "inviteCode": "ABC123",
  "members": ["ãƒ¦ãƒ¼ã‚¶ãƒ¼ID1", "ãƒ¦ãƒ¼ã‚¶ãƒ¼ID2"]
}
```

### ğŸ‘¤ **ãƒ¦ãƒ¼ã‚¶ãƒ¼ (`users` ã‚³ãƒ¬ã‚¯ã‚·ãƒ§ãƒ³)**
```json
{
  "uid": "ãƒ¦ãƒ¼ã‚¶ãƒ¼ID",
  "firstName": "å¤ªéƒ",
  "lastName": "å±±ç”°",
  "displayName": "ã‚„ã¾ã ãŸã‚ã†",
  "email": "example@example.com",
  "birthdate": "2000-01-01",
  "fcmToken": "ãƒ‡ãƒã‚¤ã‚¹ã®ãƒˆãƒ¼ã‚¯ãƒ³"
}
```

---

## ğŸš€ **ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—æ–¹æ³•**
### 1ï¸âƒ£ Firebaseãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®ä½œæˆ
- Firebase Console ã§æ–°è¦ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã‚’ä½œæˆ
- **Authentication**, **Firestore**, **Cloud Messaging** ã‚’æœ‰åŠ¹åŒ–
- `GoogleService-Info.plist` ã‚’ Xcode ã«è¿½åŠ 

### 2ï¸âƒ£ å¿…è¦ãªãƒ©ã‚¤ãƒ–ãƒ©ãƒªã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«
```bash
pod install
```

### 3ï¸âƒ£ Cloud Functions ã®ãƒ‡ãƒ—ãƒ­ã‚¤
```bash
cd firebase/functions
firebase deploy
```

---

## ğŸ“œ **ä¸»ãªãƒ•ã‚¡ã‚¤ãƒ«ã®èª¬æ˜**
### ğŸ  **ã‚¢ãƒ—ãƒªã®ãƒ¡ã‚¤ãƒ³ãƒ“ãƒ¥ãƒ¼**
ğŸ“‚ `ContentView.swift`
```swift
if session.isLoggedIn {
    TabView {
        NavigationView { HomeView() }
            .tabItem { Label("ãƒ›ãƒ¼ãƒ ", systemImage: "house") }
        
        NavigationView { GroupListView() }
            .tabItem { Label("ã‚°ãƒ«ãƒ¼ãƒ—", systemImage: "person.3") }
        
        NavigationView { SettingsView() }
            .tabItem { Label("è¨­å®š", systemImage: "gear") }
    }
} else {
    LoginView(isLoggedIn: $session.isLoggedIn)
}
```

---

## ğŸ”¥ **é€šçŸ¥ã®ä»•çµ„ã¿**
ğŸ“‚ `NotificationManager.swift`
```swift
func sendGroupNotification(for group: Group, title: String, body: String) {
    let db = Firestore.firestore()
    db.collection("groups").document(group.id).getDocument { document, error in
        if let document = document, let data = document.data(),
           let members = data["members"] as? [String] {
            
            db.collection("devices").whereField("userId", in: members).getDocuments { snapshot, error in
                let tokens = snapshot?.documents.flatMap { $0.data()["fcmTokens"] as? [String] ?? [] } ?? []
                for token in tokens {
                    self.sendNotification(to: token, title: title, body: body)
                }
            }
        }
    }
}
```

ğŸ“‚ `index.js` (Firebase Cloud Functions)
```js
exports.sendPushNotification = functions.https.onRequest(async (req, res) => {
  const {token, title, body} = req.body;
  const accessToken = await getAccessToken();
  const message = { message: { token, notification: { title, body } } };
  
  const response = await fetch(`https://fcm.googleapis.com/v1/projects/sharedshoppinglist-feecd/messages:send`, {
    method: "POST",
    headers: {
      "Authorization": `Bearer ${accessToken}`,
      "Content-Type": "application/json"
    },
    body: JSON.stringify(message),
  });

  res.status(200).send(await response.json());
});
```

---
